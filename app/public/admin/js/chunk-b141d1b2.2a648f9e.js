(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-b141d1b2"],{"29a8":function(t,e,r){"use strict";r.r(e);var a=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{staticClass:"page"},[r("div",{staticClass:"page-content"},[r("div",{staticClass:"page-tools"},[r("h3",[t._v("环境设置")]),r("el-button",{attrs:{type:"primary",plain:"",icon:"el-icon-refresh"},on:{click:function(e){return t.query()}}},[t._v("刷新")]),r("el-button",{attrs:{type:"success",plain:"",icon:"el-icon-circle-check-outline"},on:{click:function(e){return t.doSave()}}},[t._v("保存")])],1),r("div",{staticClass:"page-wrapper form-wrapper"},[r("el-form",{attrs:{model:t.form}},[r("el-form-item",{attrs:{label:"手动调票票数：","label-width":"130px"}},[r("el-input",{ref:"addVoteNum",staticStyle:{width:"100px"},attrs:{clearable:"",maxlength:"10"},model:{value:t.form.addVoteNum,callback:function(e){t.$set(t.form,"addVoteNum",e)},expression:"form.addVoteNum"}}),r("span",{staticClass:"form-tip"},[t._v("每次手动调票增加的票数,可以设置成负数")])],1),r("el-form-item",{attrs:{label:"钻石票比率：","label-width":"130px"}},[r("el-input",{ref:"rewardRatio",staticStyle:{width:"100px"},attrs:{clearable:"",maxlength:"10"},model:{value:t.form.rewardRatio,callback:function(e){t.$set(t.form,"rewardRatio",e)},expression:"form.rewardRatio"}}),r("span",{staticClass:"form-tip"},[t._v("1元钱对应的钻石票数")])],1),r("el-form-item",{attrs:{label:"打赏金额配置：","label-width":"130px"}},[r("el-input",{ref:"rewardList",style:{width:t.textareaWidth+"px"},attrs:{maxlength:"50",clearable:""},model:{value:t.form.rewardList,callback:function(e){t.$set(t.form,"rewardList",e)},expression:"form.rewardList"}}),r("span",{staticClass:"form-tip",staticStyle:{display:"block"}},[t._v("0表示可自定义金额,英文逗号间隔")])],1),r("el-form-item",{attrs:{label:"打赏总开关：","label-width":"130px"}},[r("el-switch",{model:{value:t.form.rewardSwitch,callback:function(e){t.$set(t.form,"rewardSwitch",e)},expression:"form.rewardSwitch"}}),r("span",{staticClass:"form-tip"},[t._v(t._s(t.form.rewardSwitch?"已开启":"已关闭"))])],1),r("el-form-item",{attrs:{label:"每秒钟投票限制：","label-width":"130px"}},[r("el-input",{ref:"voteLimit",staticStyle:{width:"100px"},attrs:{maxlength:"10",clearable:""},model:{value:t.form.voteLimit,callback:function(e){t.$set(t.form,"voteLimit",e)},expression:"form.voteLimit"}}),r("span",{staticClass:"form-tip"},[t._v("一秒钟之内选手的投票数超过此数字,系统将自动禁止该选手的投票")])],1),r("el-form-item",{staticStyle:{display:"none"},attrs:{label:"背景音乐：","label-width":"130px"}},[r("el-input",{ref:"backgroundMusic",style:{width:t.textareaWidth+"px"},attrs:{maxlength:"500",clearable:""},model:{value:t.form.backgroundMusic,callback:function(e){t.$set(t.form,"backgroundMusic",e)},expression:"form.backgroundMusic"}}),r("el-upload",{staticStyle:{"margin-top":"5px"},attrs:{accept:"audio/mpeg",multiple:!1,"on-exceed":t.handleUploadExceed,action:t.uploadAction,"on-remove":t.handleMusicRemove,limit:1,"file-list":t.fileList,"on-success":t.handleUploadSuccess}},[r("el-button",{attrs:{size:"small",type:"primary"}},[t._v("点击上传")])],1)],1)],1)],1)])])},i=[],o=(r("8f42"),r("cb47"),r("4634"),r("ea6e"),r("46f1")),s=r("f1ed"),n=(r("cb63"),{name:"Dict",computed:{textareaWidth:function(){var t=this.$store.state,e=720;return e=t.navState?parseInt(.9*(t.winWidth-500)):parseInt(.9*(t.winWidth-300)),e>980?e=980:e<720&&(e=720),e}},data:function(){return{fileList:[],uploadAction:"/api/music",form:{backgroundMusic:"",rewardSwitch:!0,voteLimit:"",rewardRatio:3,rewardList:"",addVoteNum:10},loading:null}},created:function(){var t=this,e=t.$store,r=e.state;t.uploadAction="/api/music?_csrf=".concat(Object(s["b"])("csrfToken"),"&uid=").concat(r.userId,"&Authorization=Bearer ").concat(r.userToken),e.commit("setRoutePath",[{label:"环境设置",name:"dict"}]),e.commit("switchActiveMenu","dict"),t.query()},methods:{query:function(){var t=this,e=t.$store;t.$ajax({url:o["a"].getDict}).then((function(r){if(200==r.code){var a=r.data,i=t.form;a.forEach((function(t){i[t.dictKey]=t.dictValue})),i.rewardSwitch="1"==i.rewardSwitch}e.commit("switchLoading",!1)}))},showLoading:function(){var t=this;t.loading=this.$loading({lock:!0,text:"数据处理中...",spinner:"el-icon-loading",background:"rgba(0, 0, 0, 0.7)"})},doSave:function(){var t=this;if(t.checkForm()){t.showLoading();var e=t.form;t.$ajax({url:o["a"].updateDict,method:"post",data:{backgroundMusic:e.backgroundMusic,rewardSwitch:e.rewardSwitch?"1":"0",voteLimit:e.voteLimit,rewardRatio:e.rewardRatio,rewardList:e.rewardList,addVoteNum:e.addVoteNum}}).then((function(e){200==e.code&&e.data?t.$message({type:"success",message:"保存成功!"}):t.$message({type:"error",message:"保存失败!"}),setTimeout((function(){t.loading.close()}),500)}))}},checkForm:function(){var t=this,e=t.$refs,r=t.form,a=r.addVoteNum.trim();if(!a)return t.$notify({type:"error",title:"提醒",message:"请输入手动调票票数!"}),e.addVoteNum.focus(),!1;if(isNaN(a))return t.$notify({type:"error",title:"提醒",message:"手动调票票数应输入数字!"}),e.addVoteNum.focus(),!1;r.addVoteNum=parseInt(a)+"";var i=r.rewardRatio.trim();if(!i)return t.$notify({type:"error",title:"提醒",message:"请输入钻石票比率!"}),e.rewardRatio.focus(),!1;if(isNaN(i))return t.$notify({type:"error",title:"提醒",message:"钻石票比率应输入数字!"}),e.rewardRatio.focus(),!1;if(Number(i)<=0)return t.$notify({type:"error",title:"提醒",message:"钻石票比率应输入大于0的数字!"}),e.rewardRatio.focus(),!1;r.rewardRatio=i;var o=r.rewardList.trim();if(!o)return t.$notify({type:"error",title:"提醒",message:"请输入打赏金额配置!"}),e.rewardList.focus(),!1;r.rewardList=o;var s=r.voteLimit.trim();if(!s)return t.$notify({type:"error",title:"提醒",message:"请输入每秒钟投票限制!"}),e.voteLimit.focus(),!1;if(isNaN(s))return t.$notify({type:"error",title:"提醒",message:"每秒钟投票限制应输入数字!"}),e.voteLimit.focus(),!1;if(Number(s)<=0)return t.$notify({type:"error",title:"提醒",message:"每秒钟投票限制应输入大于0的数字!"}),e.voteLimit.focus(),!1;r.voteLimit=s;var n=r.backgroundMusic.trim();return r.backgroundMusic=n,!0},handleUploadSuccess:function(t,e,r){this.form.backgroundMusic=t.url},handleMusicRemove:function(){this.form.backgroundMusic=""},handleUploadExceed:function(){this.$notify({type:"error",title:"提醒",message:"请先上传已删除的音乐文件!"})}}}),c=n,l=r("6691"),u=Object(l["a"])(c,a,i,!1,null,null,null);e["default"]=u.exports},"3a06":function(t,e){t.exports="\t\n\v\f\r   ᠎             　\u2028\u2029\ufeff"},7130:function(t,e,r){var a=r("2498"),i=r("3038"),o=r("0cc1"),s=r("3a06"),n="["+s+"]",c="​",l=RegExp("^"+n+n+"*"),u=RegExp(n+n+"*$"),d=function(t,e,r){var i={},n=o((function(){return!!s[t]()||c[t]()!=c})),l=i[t]=n?e(f):s[t];r&&(i[r]=l),a(a.P+a.F*n,"String",i)},f=d.trim=function(t,e){return t=String(i(t)),1&e&&(t=t.replace(l,"")),2&e&&(t=t.replace(u,"")),t};t.exports=d},"8f42":function(t,e,r){"use strict";var a=r("3f8b"),i=r("549d"),o=r("6077"),s=r("1e01"),n=r("2ab1"),c=r("0cc1"),l=r("cb2e").f,u=r("e493").f,d=r("d3d8").f,f=r("7130").trim,m="Number",p=a[m],h=p,w=p.prototype,v=o(r("65c3")(w))==m,b="trim"in String.prototype,g=function(t){var e=n(t,!1);if("string"==typeof e&&e.length>2){e=b?e.trim():f(e,3);var r,a,i,o=e.charCodeAt(0);if(43===o||45===o){if(r=e.charCodeAt(2),88===r||120===r)return NaN}else if(48===o){switch(e.charCodeAt(1)){case 66:case 98:a=2,i=49;break;case 79:case 111:a=8,i=55;break;default:return+e}for(var s,c=e.slice(2),l=0,u=c.length;l<u;l++)if(s=c.charCodeAt(l),s<48||s>i)return NaN;return parseInt(c,a)}}return+e};if(!p(" 0o1")||!p("0b1")||p("+0x1")){p=function(t){var e=arguments.length<1?0:t,r=this;return r instanceof p&&(v?c((function(){w.valueOf.call(r)})):o(r)!=m)?s(new h(g(e)),r,p):g(e)};for(var y,x=r("f9a5")?l(h):"MAX_VALUE,MIN_VALUE,NaN,NEGATIVE_INFINITY,POSITIVE_INFINITY,EPSILON,isFinite,isInteger,isNaN,isSafeInteger,MAX_SAFE_INTEGER,MIN_SAFE_INTEGER,parseFloat,parseInt,isInteger".split(","),N=0;x.length>N;N++)i(h,y=x[N])&&!i(p,y)&&d(p,y,u(h,y));p.prototype=w,w.constructor=p,r("a6d5")(a,m,p)}},cb47:function(t,e,r){"use strict";r("7130")("trim",(function(t){return function(){return t(this,3)}}))}}]);