(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-47804c61"],{"1c72":function(t,e,a){},"93b5":function(t,e,a){"use strict";a.r(e);var n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"page complaint-list-page"},[a("div",{staticClass:"page-content"},[a("div",{staticClass:"page-tools"},[a("h3",[t._v("用户投诉")]),a("el-button",{attrs:{type:"primary",plain:"",icon:"el-icon-refresh"},on:{click:function(e){return t.queryData()}}},[t._v("刷新")])],1),a("el-tabs",{attrs:{type:"card"},on:{"tab-click":t.doSwitchTab},model:{value:t.activeTab,callback:function(e){t.activeTab=e},expression:"activeTab"}},[a("el-tab-pane",{attrs:{label:"所有状态",name:"all"}}),a("el-tab-pane",{attrs:{label:"未处理",name:"untreated"}}),a("el-tab-pane",{attrs:{label:"已处理",name:"treated"}})],1),a("div",{staticClass:"page-wrapper",style:{width:t.tableWidth+"px"}},[a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],attrs:{data:t.dataList,border:"",stripe:"","element-loading-text":"数据加载中...","element-loading-spinner":"el-icon-loading","element-loading-background":"rgba(0, 0, 0, 0.5)"}},[a("el-table-column",{attrs:{label:"序号",width:"60",type:"index",align:"center",index:t.getIndex}}),a("el-table-column",{attrs:{prop:"title","min-width":"120",label:"活动名称",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("a",{staticClass:"title-link",attrs:{title:"点击查看活动详情"},on:{click:function(a){return t.doViewActDetail(e.row)}}},[t._v(t._s(e.row.title))])]}}])}),a("el-table-column",{attrs:{prop:"name",width:"120",label:"用户名称",align:"center"}}),a("el-table-column",{attrs:{prop:"tel",width:"120",label:"手机号码",align:"center"}}),a("el-table-column",{attrs:{prop:"createdAt",width:"160",label:"投诉时间",align:"center"}}),a("el-table-column",{attrs:{prop:"content","min-width":"160",label:"投诉内容",align:"center"}}),a("el-table-column",{attrs:{prop:"statusText",width:"70",label:"状态",align:"center"}}),a("el-table-column",{attrs:{width:"113",label:"操作",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return["0"==e.row.status?a("el-button",{staticStyle:{"margin-left":"0"},attrs:{plain:"",type:"primary",size:"mini"},on:{click:function(a){return t.doHandler(e.row)}}},[t._v("标记为已处理")]):t._e()]}}])})],1)],1),a("el-pagination",{directives:[{name:"show",rawName:"v-show",value:t.total,expression:"total"}],attrs:{"current-page":t.currentPage,"page-sizes":[10,35,50],"page-size":t.currentPageSize,background:"",layout:"total, sizes, prev, pager, next",total:t.total},on:{"size-change":t.handleSizeChange,"current-change":t.handleCurrentPageChange,"update:currentPage":function(e){t.currentPage=e},"update:current-page":function(e){t.currentPage=e}}})],1)])},r=[],i=(a("34a3"),a("7364"),a("11ac"),a("46f1")),l=a("f1ed"),c={0:"未处理",1:"已处理"},o={name:"ComplaintList",computed:{tableWidth:function(){var t=this.$store.state;return t.winWidth-(t.navState?280:104)},tableHeight:function(){return this.$store.state.winHeight-215}},data:function(){return{actId:"",dataList:[],loading:!0,currentPage:1,currentPageSize:10,total:0,activeTab:"all"}},created:function(){var t=this,e=t.$store;e.commit("switchActiveMenu","complaint"),e.commit("setRoutePath",[{label:"用户投诉",name:"complaint"}]),e.commit("switchLoading",!1);var a=t.$route,n=a.query;t.actId=n.aId||"",t.activeTab=n.s||"all",t.currentPage=parseInt(n.p||1),t.currentPageSize=parseInt(n.g||10),t.queryData()},methods:{queryData:function(){var t=this;t.loading=!0,t.$ajax({url:i["a"].getComplaints,params:{actId:t.actId,pageSize:t.currentPageSize,page:t.currentPage,status:t.activeTab}}).then(function(e){200==e.code&&(e.data?(t.total=e.data.total,t.dataList=e.data.dataList.map(function(t){return t.createdAt=Object(l["d"])(new Date(t.createdAt)),t.statusText=c[t.status],t})):(t.total=0,t.dataList=[]),t.refreshUrl(),setTimeout(function(){t.loading=!1},200))})},doViewActDetail:function(t){this.$router.push({name:"actDetail",query:{id:t.actId}})},doSwitchTab:function(){var t=this;t.currentPage=1,t.queryData()},handleSizeChange:function(t){this.currentPageSize=t,this.currentPage=1,this.queryData()},handleCurrentPageChange:function(t){this.currentPage=t,this.queryData()},getIndex:function(t){return(this.currentPage-1)*this.currentPageSize+t+1},refreshUrl:function(){var t=this;"complaint"==t.$route.name&&t.$router.replace({name:"complaint",query:{aId:t.actId,s:t.activeTab,p:t.currentPage,g:t.currentPageSize}})},doHandler:function(t){var e=this;e.$confirm("是否已经处理了这条用户投诉?","提醒",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning",closeOnClickModal:!1,confirmButtonClass:"el-button--danger el-button--medium is-plain",cancelButtonClass:"el-button--primary el-button--medium is-plain"}).then(function(){e.$ajax({url:i["a"].treatComplaint+t.id,method:"PUT"}).then(function(t){200==t.code?(e.$message({type:"success",message:"操作成功!"}),e.queryData()):e.$message({type:"error",message:"操作失败!"})})})}}},s=o,u=(a("a6d7"),a("6691")),d=Object(u["a"])(s,n,r,!1,null,null,null);e["default"]=d.exports},a6d7:function(t,e,a){"use strict";var n=a("1c72"),r=a.n(n);r.a}}]);