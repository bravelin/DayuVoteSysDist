(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-29b83106"],{"10c2":function(e,t,a){"use strict";var o=["超级管理员","一级管理员","二级管理员"];t["a"]=o},"539d":function(e,t,a){var o=a("b2f5"),n=a("f01a"),r=a("b6f1"),l=a("c9ea"),i="["+l+"]",s="​",c=RegExp("^"+i+i+"*"),u=RegExp(i+i+"*$"),m=function(e,t,a){var n={},i=r(function(){return!!l[e]()||s[e]()!=s}),c=n[e]=i?t(d):l[e];a&&(n[a]=c),o(o.P+o.F*i,"String",n)},d=m.trim=function(e,t){return e=String(n(e)),1&t&&(e=e.replace(c,"")),2&t&&(e=e.replace(u,"")),e};e.exports=m},"5d70":function(e,t,a){"use strict";a.r(t);var o=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"page"},[a("div",{staticClass:"page-content"},[a("div",{staticClass:"page-tools"},[a("h3",[e._v("账号列表")]),a("el-button",{attrs:{type:"primary",plain:"",icon:"el-icon-refresh"},on:{click:function(t){return e.doRefresh()}}},[e._v("刷新")]),a("el-button",{attrs:{type:"success",plain:"",icon:"el-icon-circle-plus-outline"},on:{click:function(t){return e.doAdd()}}},[e._v("添加下级账号")])],1),a("div",{staticClass:"page-wrapper",style:{width:e.tableWidth+"px"}},[a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticStyle:{width:"100%"},attrs:{data:e.dataList,border:"",stripe:"","element-loading-text":"数据加载中...","element-loading-spinner":"el-icon-loading","element-loading-background":"rgba(0, 0, 0, 0.5)"}},[a("el-table-column",{attrs:{label:"序号",width:"70",type:"index",align:"center"}}),a("el-table-column",{attrs:{prop:"loginName",label:"登录名",align:"center"}}),a("el-table-column",{attrs:{prop:"realName",label:"真实名称",align:"center"}}),a("el-table-column",{attrs:{prop:"role",label:"级别",align:"center"}}),a("el-table-column",{attrs:{prop:"miniPower",label:"权限",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",{style:{color:"1"==t.row.miniPower?"#f66":"#67c23a"}},[e._v(e._s("1"==t.row.miniPower?"最小权限":"所有权限"))])]}}])}),a("el-table-column",{attrs:{prop:"createdAt",label:"创建时间",align:"center"}}),a("el-table-column",{attrs:{label:"操作",width:"230",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{plain:"",type:"primary",size:"mini"},on:{click:function(a){return e.doResetPassword(t.row)}}},[e._v("重置密码")]),"二级管理员"==t.row.role?a("el-button",{attrs:{plain:"",type:"warning",size:"mini"},on:{click:function(a){return e.switchMiniPower(t.row)}}},[e._v("修改权限")]):e._e(),a("el-button",{attrs:{plain:"",type:"danger",size:"mini"},on:{click:function(a){return e.doDel(t.row)}}},[e._v("删除")])]}}])})],1)],1)]),a("el-dialog",{attrs:{title:"新增账号",visible:e.dialogVisible,width:"450px","close-on-click-modal":!1},on:{"update:visible":function(t){e.dialogVisible=t}}},[a("el-form",{attrs:{model:e.form}},[a("el-form-item",{attrs:{label:"登录名称：","label-width":"85px"}},[a("el-input",{ref:"loginName",attrs:{autofocus:"true",autocomplete:"off",clearable:"",placeholder:"请输入账号的登录名称",maxlength:"50"},model:{value:e.form.loginName,callback:function(t){e.$set(e.form,"loginName",t)},expression:"form.loginName"}})],1),a("el-form-item",{attrs:{label:"真实名称：","label-width":"85px"}},[a("el-input",{ref:"realName",attrs:{autocomplete:"off",clearable:"",placeholder:"请输入账号的真实名称",maxlength:"50"},model:{value:e.form.realName,callback:function(t){e.$set(e.form,"realName",t)},expression:"form.realName"}})],1),a("el-form-item",{attrs:{label:"账号级别：","label-width":"85px"}},[a("el-input",{attrs:{disabled:""},model:{value:e.form.role,callback:function(t){e.$set(e.form,"role",t)},expression:"form.role"}})],1),1==e.userRole?a("el-form-item",{attrs:{label:"权限设置：","label-width":"85px"}},[a("el-radio-group",{model:{value:e.form.miniPower,callback:function(t){e.$set(e.form,"miniPower",t)},expression:"form.miniPower"}},[a("el-radio",{attrs:{label:!0}},[e._v("最小权限")]),a("el-radio",{attrs:{label:!1}},[e._v("所有权限")])],1)],1):e._e(),a("el-form-item",{attrs:{label:"登录密码：","label-width":"85px"}},[a("el-input",{ref:"loginPassword",attrs:{type:"password",autocomplete:"off",clearable:"",placeholder:"请输入账号的密码,至少6位数字和字母",maxlength:"50"},model:{value:e.form.loginPassword,callback:function(t){e.$set(e.form,"loginPassword",t)},expression:"form.loginPassword"}})],1),a("el-form-item",{staticStyle:{"margin-bottom":"0"},attrs:{label:"确认密码：","label-width":"85px"}},[a("el-input",{ref:"repeatPassword",attrs:{type:"password",autocomplete:"off",clearable:"",placeholder:"请再次输入账号的密码",maxlength:"50"},model:{value:e.form.repeatPassword,callback:function(t){e.$set(e.form,"repeatPassword",t)},expression:"form.repeatPassword"}})],1)],1),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{type:"primary",plain:""},on:{click:function(t){e.dialogVisible=!1}}},[e._v("取 消")]),a("el-button",{attrs:{type:"success",plain:""},on:{click:function(t){return e.doConfirm()}}},[e._v("确 定")])],1)],1)],1)},n=[],r=(a("e836"),a("11ac"),a("f1ed")),l=a("46f1"),i=a("10c2"),s={name:"Accounts",computed:{tableWidth:function(){var e=this.$store.state;return e.winWidth-(e.navState?280:104)},userRole:function(){return this.$store.state.userRole}},data:function(){return{dataList:[],dialogVisible:!1,loading:!0,form:{loginName:"",realName:"",loginPassword:"",repeatPassword:"",role:"",miniPower:!1},dialogLoading:null}},created:function(){var e=this;e.$store.commit("setRoutePath",[{label:"账号管理",name:"accounts"}]),e.$store.commit("switchLoading",!1),e.$store.commit("switchActiveMenu","accounts"),this.queryData()},methods:{queryData:function(){var e=this;e.loading=!0,e.$ajax({url:l["a"].getAccounts}).then(function(t){200==t.code&&(e.dataList=t.data.map(function(e){return e.role=i["a"][e.role],e.createdAt=Object(r["d"])(new Date(e.createdAt)),e}),setTimeout(function(){e.loading=!1},200))})},switchMiniPower:function(e){var t=this,a="1"==e.miniPower?"0":"1";t.$confirm("将".concat(e.realName,"的账号权限切换成").concat("1"==a?"最小权限":"所有权限","，是否继续?"),"提醒",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning",closeOnClickModal:!1,confirmButtonClass:"el-button--danger el-button--medium is-plain",cancelButtonClass:"el-button--primary el-button--medium is-plain"}).then(function(){t.$ajax({method:"POST",url:l["a"].switchMiniPower+e.id,data:{miniPower:a}}).then(function(a){200==a.code?(t.$message({type:"success",message:"".concat(e.realName,"的账号权限修改成功!")}),t.queryData()):t.$message({type:"error",message:"".concat(e.realName,"的账号权限修改失败!")})})})},doResetPassword:function(e){var t=this;t.$confirm("将重置".concat(e.realName,"的账号密码，是否继续?"),"提醒",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning",closeOnClickModal:!1,confirmButtonClass:"el-button--danger el-button--medium is-plain",cancelButtonClass:"el-button--primary el-button--medium is-plain"}).then(function(){var a=Object(r["e"])(10,20);t.$ajax({method:"PUT",url:l["a"].resetPassword+e.id,data:{password:Object(r["a"])(a)}}).then(function(o){200==o.code?t.$notify({title:"提醒",message:"".concat(e.realName,"的账号密码已被重置为：").concat(a),duration:0,type:"success",position:"bottom-right"}):t.$message({type:"error",message:"".concat(e.realName,"的账号密码重置失败!")})})})},doDel:function(e){var t=this;t.$confirm("将删除".concat(e.realName,"的账号，是否继续?"),"提醒",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning",closeOnClickModal:!1,confirmButtonClass:"el-button--danger el-button--medium is-plain",cancelButtonClass:"el-button--primary el-button--medium is-plain"}).then(function(){t.$ajax({method:"DELETE",url:l["a"].delAccount+e.id}).then(function(a){200==a.code?(t.$message({type:"success",message:"成功删除".concat(e.realName,"的账号!")}),t.doRefresh()):t.$message({type:"error",message:"".concat(e.realName,"的账号删除失败!")})})})},doRefresh:function(){this.queryData()},doCheck:function(){var e=this,t=e.$refs,a=e.form,o=a.loginName.trim();if(!o)return e.$notify({type:"error",title:"提醒",message:"请输入账号的登录名称!"}),t.loginName.focus(),!1;a.loginName=o;var n=a.realName.trim();if(!n)return e.$notify({type:"error",title:"提醒",message:"请输入账号的真实名称!"}),t.realName.focus(),!1;a.realName=n;var r=a.loginPassword.trim();if(!r)return e.$notify({type:"error",title:"提醒",message:"请输入账号的密码!"}),t.loginPassword.focus(),!1;if(a.loginPassword=r,r.length<6)return e.$notify({type:"error",title:"提醒",message:"账号的密码请输入至少6位数字和字母!"}),t.loginPassword.focus(),!1;var l=a.repeatPassword.trim();return l?(a.repeatPassword=l,l==r||(e.$notify({type:"error",title:"提醒",message:"两次输入的密码不一致!请仔细检查一下!"}),!1)):(e.$notify({type:"error",title:"提醒",message:"请再次输入账号的密码!"}),t.repeatPassword.focus(),!1)},doConfirm:function(){var e=this,t=e.form;e.doCheck()&&(e.dialogLoading=e.$loading({lock:!0,text:"正在处理,请稍候......",spinner:"el-icon-loading",background:"rgba(0, 0, 0, 0.5)"}),e.$ajax({url:l["a"].addAccount,method:"POST",data:{loginName:t.loginName,realName:t.realName,loginPassword:Object(r["a"])(t.loginPassword),role:parseInt(e.$store.state.userRole)+1,miniPower:t.miniPower?"1":"0"}}).then(function(a){200==a.code?(e.$message({type:"success",message:"账号".concat(t.loginName,"创建成功!")}),e.dialogVisible=!1,e.doRefresh()):e.$notify({type:"error",title:"提醒",message:a.message}),e.dialogLoading.close()}))},doAdd:function(){var e=this,t=e.form;t.loginName="",t.realName="",t.loginPassword="",t.repeatPassword="",0==e.$store.state.userRole?t.role="一级管理员":t.role="二级管理员",e.dialogVisible=!0}}},c=s,u=a("6691"),m=Object(u["a"])(c,o,n,!1,null,null,null);t["default"]=m.exports},c9ea:function(e,t){e.exports="\t\n\v\f\r   ᠎             　\u2028\u2029\ufeff"},e836:function(e,t,a){"use strict";a("539d")("trim",function(e){return function(){return e(this,3)}})}}]);