(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-6a971d96"],{"47a1":function(t,e,a){"use strict";var i=a("b460"),n=a.n(i);n.a},b1ec:function(t,e,a){"use strict";a.r(e);var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"page visit-stat-page"},[a("div",{staticClass:"page-content"},[a("div",{staticClass:"page-tools"},[a("h3",[t._v(t._s(t.actTitle)),a("span",{directives:[{name:"show",rawName:"v-show",value:t.playerInfo,expression:"playerInfo"}]},[t._v(t._s(t.playerInfo))]),t._v("访问统计")]),a("el-button",{attrs:{type:"primary",plain:"",icon:"el-icon-refresh"},on:{click:function(e){return t.queryData()}}},[t._v("刷新")]),a("el-button",{attrs:{type:"warning",plain:"",icon:"el-icon-back"},on:{click:function(e){return t.doBack()}}},[t._v("返回")])],1),a("div",{ref:"container",staticClass:"container",style:{height:t.winHeight-160+"px"}})])])},n=[],r=(a("e10e"),a("6d57"),a("ff21"),a("c904"),a("cc57"),a("3604")),o=a("46f1"),c=a("f1ed"),s={name:"VoteStat",computed:{winHeight:function(){return this.$store.state.winHeight}},data:function(){return{actTitle:"",actId:"",playerId:"",container:null,chart:null,titles:[],datas:[],voteStartTime:null,playerInfo:""}},created:function(){var t=this,e=t.$store;e.commit("switchActiveMenu","acts"),e.commit("setRoutePath",[{label:"投票记录",name:"votes"},{label:"访问统计",name:"visitStat"}]),e.commit("switchLoading",!1)},mounted:function(){var t=this;t.$nextTick((function(){t.container=t.$refs.container,t.init()}))},methods:{init:function(){var t=this,e=t.$route,a=e.query;t.actId=a.id||"",t.playerId=a.pId||"",t.actId?t.queryActDetail():t.queryData(),t.playerId&&t.queryPlayerDetail()},queryPlayerDetail:function(){var t=this;t.$ajax({url:o["a"].getPlayer+t.playerId}).then((function(e){if(200==e.code){var a=e.data;t.playerInfo="".concat(a.no,'号选手"').concat(a.name,'"')}}))},queryActDetail:function(){var t=this;t.$ajax({url:o["a"].getActivity+t.actId}).then((function(e){if(200==e.code){var a=e.data;t.actTitle=a.title;var i=new Date(a.voteStartTime);i.getTime()<+new Date&&(t.voteStartTime=i,t.queryData())}else t.$router.back()}))},queryData:function(){var t=this,e=864e5;t.$ajax({url:o["a"].getVisitDateStat,method:"post",data:{actId:t.actId||"",playerId:t.playerId||""}}).then((function(a){if(200==a.code){var i=a.data||[],n={};i.sort((function(t,e){return t.days>e.days?1:-1}));var r=t.voteStartTime?new Date(t.voteStartTime):new Date;if(i.length&&i[0].days<Object(c["d"])(r,"yyyyMMdd")){var o=i[0].days;r.setDate(o.slice(6,8)),r.setMonth(o.slice(4,6)-1),r.setFullYear(o.slice(0,4))}var s=new Date;s.setHours(23,59,59,0);var l="";while(r.getTime()<=s.getTime())l=Object(c["d"])(r,"yyyyMMdd"),n[l]=0,r.setTime(r.getTime()+e);i.forEach((function(t){n[t.days]=t.visitNum?t.visitNum-0:0}));var u=[],d=[];Object.keys(n).forEach((function(t){d.push(Object(c["c"])(t,".")),u.push(n[t])})),t.chart?t.refreshChart(d,u):t.createChart(d,u)}}))},refreshChart:function(t,e){var a=this,i=a.chart,n=i.getOption(),r=n.series,o=n.xAxis;r[0].data=e,o[0].data=t,i.setOption({series:r,xAxis:o})},createChart:function(t,e){var a=this,i={grid:{top:30,left:30,right:40,bottom:20,containLabel:!0},tooltip:{trigger:"axis"},legend:{show:!1},xAxis:[{type:"category",boundaryGap:!1,axisLine:{lineStyle:{color:"#e0e0e0"}},axisLabel:{margin:15,textStyle:{fontSize:12,color:"#9933FF"}},data:t}],yAxis:[{type:"value",axisTick:{show:!1},axisLine:{lineStyle:{color:"#e0e0e0"}},axisLabel:{margin:10,textStyle:{fontSize:12,color:"#9933FF"}},splitLine:{lineStyle:{color:"#e0e0e0",type:"dotted"}}}],series:[{name:"访问量",type:"line",smooth:!0,symbol:"circle",symbolSize:5,showSymbol:!1,data:e}]};a.chart=r["a"].init(a.container),a.chart.setOption(i)},doBack:function(){var t=this;t.$router.back()}}},l=s,u=(a("47a1"),a("623f")),d=Object(u["a"])(l,i,n,!1,null,null,null);e["default"]=d.exports},b460:function(t,e,a){}}]);